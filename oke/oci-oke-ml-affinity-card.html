<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>

<link href='https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext' rel='stylesheet' type='text/css' /><style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color:#ffffff; --text-color:#333333; --select-text-bg-color:#B5D6FC; --select-text-font-color:auto; --monospace:"Lucida Console",Consolas,"Courier",monospace; --title-bar-height:20px; }
.mac-os-11 { --title-bar-height:28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; bottom: 0px; top: 0px; left: 0px; right: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; tab-size: 4; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror-linenumber { user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-fences-adv-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; padding-top: 0px; border-color: transparent !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
  .typora-export-show-outline .typora-export-sidebar { display: none; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.8; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.md-inline-math .MathJax_SVG .noError { display: none !important; }
.html-for-mac .inline-math-svg .MathJax_SVG { vertical-align: 0.2px; }
.md-fences-math .MathJax_SVG_Display, .md-math-block .MathJax_SVG_Display { text-align: center; margin: 0px; position: relative; text-indent: 0px; max-width: none; max-height: none; min-height: 0px; min-width: 100%; width: auto; overflow-y: visible; display: block !important; }
.MathJax_SVG_Display, .md-inline-math .MathJax_SVG_Display { width: auto; margin: inherit; display: inline-block !important; }
.MathJax_SVG .MJX-monospace { font-family: var(--monospace); }
.MathJax_SVG .MJX-sans-serif { font-family: sans-serif; }
.MathJax_SVG { display: inline; font-style: normal; font-weight: 400; line-height: normal; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; zoom: 90%; }
#math-inline-preview-content { zoom: 1.1; }
.MathJax_SVG * { transition: none 0s ease 0s; }
.MathJax_SVG_Display svg { vertical-align: middle !important; margin-bottom: 0px !important; margin-top: 0px !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
.md-expand mark .md-meta { opacity: 0.3 !important; }
mark .md-meta { color: rgb(0, 0, 0); }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-require-zoom-fix foreignobject { font-size: var(--mermaid-font-zoom); }
.md-fences.md-fences-math { font-size: 1em; }
.md-fences-math .MathJax_SVG_Display { margin-top: 8px; cursor: default; }
.md-fences-advanced:not(.md-focus) { padding: 0px; white-space: nowrap; border: 0px; }
.md-fences-advanced:not(.md-focus) { background: inherit; }
.typora-export-show-outline .typora-export-content { max-width: 1440px; margin: auto; display: flex; flex-direction: row; }
.typora-export-sidebar { width: 300px; font-size: 0.8rem; margin-top: 80px; margin-right: 18px; }
.typora-export-show-outline #write { --webkit-flex:2; flex: 2 1 0%; }
.typora-export-sidebar .outline-content { position: fixed; top: 0px; max-height: 100%; overflow: hidden auto; padding-bottom: 30px; padding-top: 60px; width: 300px; }
@media screen and (max-width: 1024px) {
  .typora-export-sidebar, .typora-export-sidebar .outline-content { width: 240px; }
}
@media screen and (max-width: 800px) {
  .typora-export-sidebar { display: none; }
}
.outline-content li, .outline-content ul { margin-left: 0px; margin-right: 0px; padding-left: 0px; padding-right: 0px; list-style: none; }
.outline-content ul { margin-top: 0px; margin-bottom: 0px; }
.outline-content strong { font-weight: 400; }
.outline-expander { width: 1rem; height: 1.42857rem; position: relative; display: table-cell; vertical-align: middle; cursor: pointer; padding-left: 4px; }
.outline-expander::before { content: ""; position: relative; font-family: Ionicons; display: inline-block; font-size: 8px; vertical-align: middle; }
.outline-item { padding-top: 3px; padding-bottom: 3px; cursor: pointer; }
.outline-expander:hover::before { content: ""; }
.outline-h1 > .outline-item { padding-left: 0px; }
.outline-h2 > .outline-item { padding-left: 1em; }
.outline-h3 > .outline-item { padding-left: 2em; }
.outline-h4 > .outline-item { padding-left: 3em; }
.outline-h5 > .outline-item { padding-left: 4em; }
.outline-h6 > .outline-item { padding-left: 5em; }
.outline-label { cursor: pointer; display: table-cell; vertical-align: middle; text-decoration: none; color: inherit; }
.outline-label:hover { text-decoration: underline; }
.outline-item:hover { border-color: rgb(245, 245, 245); background-color: var(--item-hover-bg-color); }
.outline-item:hover { margin-left: -28px; margin-right: -28px; border-left: 28px solid transparent; border-right: 28px solid transparent; }
.outline-item-single .outline-expander::before, .outline-item-single .outline-expander:hover::before { display: none; }
.outline-item-open > .outline-item > .outline-expander::before { content: ""; }
.outline-children { display: none; }
.info-panel-tab-wrapper { display: none; }
.outline-item-open > .outline-children { display: block; }
.typora-export .outline-item { padding-top: 1px; padding-bottom: 1px; }
.typora-export .outline-item:hover { margin-right: -8px; border-right: 8px solid transparent; }
.typora-export .outline-expander::before { content: "+"; font-family: inherit; top: -1px; }
.typora-export .outline-expander:hover::before, .typora-export .outline-item-open > .outline-item > .outline-expander::before { content: "−"; }
.typora-export-collapse-outline .outline-children { display: none; }
.typora-export-collapse-outline .outline-item-open > .outline-children, .typora-export-no-collapse-outline .outline-children { display: block; }
.typora-export-no-collapse-outline .outline-expander::before { content: "" !important; }
.typora-export-show-outline .outline-item-active > .outline-item .outline-label { font-weight: 700; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background: inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); background: inherit; white-space: nowrap; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 30px; z-index: 3; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; background: 0px 0px !important; border: none !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: 0px 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; overflow-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { overflow-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right: 30px solid transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right: none; width: auto; }
.CodeMirror-linebackground { position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
span.cm-underlined { text-decoration: underline; }
span.cm-strikethrough { text-decoration: line-through; }
.cm-tw-syntaxerror { color: rgb(255, 255, 255); background-color: rgb(153, 0, 0); }
.cm-tw-deleted { text-decoration: line-through; }
.cm-tw-header5 { font-weight: 700; }
.cm-tw-listitem:first-child { padding-left: 10px; }
.cm-tw-box { border-style: solid; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-color: inherit; border-top-width: 0px !important; }
.cm-tw-underline { text-decoration: underline; }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


:root {
    --side-bar-bg-color: #fafafa;
    --control-text-color: #777;
}

@include-when-export url(https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext);

/* open-sans-regular - latin-ext_latin */
  /* open-sans-italic - latin-ext_latin */
    /* open-sans-700 - latin-ext_latin */
    /* open-sans-700italic - latin-ext_latin */
  html {
    font-size: 16px;
}

body {
    font-family: "Open Sans","Clear Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
    color: rgb(51, 51, 51);
    line-height: 1.6;
}

#write {
    max-width: 860px;
  	margin: 0 auto;
  	padding: 30px;
    padding-bottom: 100px;
}

@media only screen and (min-width: 1400px) {
	#write {
		max-width: 1024px;
	}
}

@media only screen and (min-width: 1800px) {
	#write {
		max-width: 1200px;
	}
}

#write > ul:first-child,
#write > ol:first-child{
    margin-top: 30px;
}

a {
    color: #4183C4;
}
h1,
h2,
h3,
h4,
h5,
h6 {
    position: relative;
    margin-top: 1rem;
    margin-bottom: 1rem;
    font-weight: bold;
    line-height: 1.4;
    cursor: text;
}
h1:hover a.anchor,
h2:hover a.anchor,
h3:hover a.anchor,
h4:hover a.anchor,
h5:hover a.anchor,
h6:hover a.anchor {
    text-decoration: none;
}
h1 tt,
h1 code {
    font-size: inherit;
}
h2 tt,
h2 code {
    font-size: inherit;
}
h3 tt,
h3 code {
    font-size: inherit;
}
h4 tt,
h4 code {
    font-size: inherit;
}
h5 tt,
h5 code {
    font-size: inherit;
}
h6 tt,
h6 code {
    font-size: inherit;
}
h1 {
    font-size: 2.25em;
    line-height: 1.2;
    border-bottom: 1px solid #eee;
}
h2 {
    font-size: 1.75em;
    line-height: 1.225;
    border-bottom: 1px solid #eee;
}

/*@media print {
    .typora-export h1,
    .typora-export h2 {
        border-bottom: none;
        padding-bottom: initial;
    }

    .typora-export h1::after,
    .typora-export h2::after {
        content: "";
        display: block;
        height: 100px;
        margin-top: -96px;
        border-top: 1px solid #eee;
    }
}*/

h3 {
    font-size: 1.5em;
    line-height: 1.43;
}
h4 {
    font-size: 1.25em;
}
h5 {
    font-size: 1em;
}
h6 {
   font-size: 1em;
    color: #777;
}
p,
blockquote,
ul,
ol,
dl,
table{
    margin: 0.8em 0;
}
li>ol,
li>ul {
    margin: 0 0;
}
hr {
    height: 2px;
    padding: 0;
    margin: 16px 0;
    background-color: #e7e7e7;
    border: 0 none;
    overflow: hidden;
    box-sizing: content-box;
}

li p.first {
    display: inline-block;
}
ul,
ol {
    padding-left: 30px;
}
ul:first-child,
ol:first-child {
    margin-top: 0;
}
ul:last-child,
ol:last-child {
    margin-bottom: 0;
}
blockquote {
    border-left: 4px solid #dfe2e5;
    padding: 0 15px;
    color: #777777;
}
blockquote blockquote {
    padding-right: 0;
}
table {
    padding: 0;
    word-break: initial;
}
table tr {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 0;
}
table tr:nth-child(2n),
thead {
    background-color: #f8f8f8;
}
table th {
    font-weight: bold;
    border: 1px solid #dfe2e5;
    border-bottom: 0;
    margin: 0;
    padding: 6px 13px;
}
table td {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 6px 13px;
}
table th:first-child,
table td:first-child {
    margin-top: 0;
}
table th:last-child,
table td:last-child {
    margin-bottom: 0;
}

.CodeMirror-lines {
    padding-left: 4px;
}

.code-tooltip {
    box-shadow: 0 1px 1px 0 rgba(0,28,36,.3);
    border-top: 1px solid #eef2f2;
}

.md-fences,
code,
tt {
    border: 1px solid #e7eaed;
    background-color: #f8f8f8;
    border-radius: 3px;
    padding: 0;
    padding: 2px 4px 0px 4px;
    font-size: 0.9em;
}

code {
    background-color: #f3f4f4;
    padding: 0 2px 0 2px;
}

.md-fences {
    margin-bottom: 15px;
    margin-top: 15px;
    padding-top: 8px;
    padding-bottom: 6px;
}


.md-task-list-item > input {
  margin-left: -1.3em;
}

@media print {
    html {
        font-size: 13px;
    }
    table,
    pre {
        page-break-inside: avoid;
    }
    pre {
        word-wrap: break-word;
    }
}

.md-fences {
	background-color: #f8f8f8;
}
#write pre.md-meta-block {
	padding: 1rem;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border: 0;
    border-radius: 3px;
    color: #777777;
    margin-top: 0 !important;
}

.mathjax-block>.code-tooltip {
	bottom: .375rem;
}

.md-mathjax-midline {
    background: #fafafa;
}

#write>h3.md-focus:before{
	left: -1.5625rem;
	top: .375rem;
}
#write>h4.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h5.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h6.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
.md-image>.md-meta {
    /*border: 1px solid #ddd;*/
    border-radius: 3px;
    padding: 2px 0px 0px 4px;
    font-size: 0.9em;
    color: inherit;
}

.md-tag {
    color: #a7a7a7;
    opacity: 1;
}

.md-toc { 
    margin-top:20px;
    padding-bottom:20px;
}

.sidebar-tabs {
    border-bottom: none;
}

#typora-quick-open {
    border: 1px solid #ddd;
    background-color: #f8f8f8;
}

#typora-quick-open-item {
    background-color: #FAFAFA;
    border-color: #FEFEFE #e5e5e5 #e5e5e5 #eee;
    border-style: solid;
    border-width: 1px;
}

/** focus mode */
.on-focus-mode blockquote {
    border-left-color: rgba(85, 85, 85, 0.12);
}

header, .context-menu, .megamenu-content, footer{
    font-family: "Segoe UI", "Arial", sans-serif;
}

.file-node-content:hover .file-node-icon,
.file-node-content:hover .file-node-open-state{
    visibility: visible;
}

.mac-seamless-mode #typora-sidebar {
    background-color: #fafafa;
    background-color: var(--side-bar-bg-color);
}

.md-lang {
    color: #b4654d;
}

/*.html-for-mac {
    --item-hover-bg-color: #E6F0FE;
}*/

#md-notification .btn {
    border: 0;
}

.dropdown-menu .divider {
    border-color: #e5e5e5;
    opacity: 0.4;
}

.ty-preferences .window-content {
    background-color: #fafafa;
}

.ty-preferences .nav-group-item.active {
    color: white;
    background: #999;
}

.menu-item-container a.menu-style-btn {
    background-color: #f5f8fa;
    background-image: linear-gradient( 180deg , hsla(0, 0%, 100%, 0.8), hsla(0, 0%, 100%, 0)); 
}



</style><title>OCI OKE : Zeppelin/PySpark 기반 적립카드 발급 대상 분석</title>
</head>
<body class='typora-export os-windows'><div class='typora-export-content'>
<div id='write'  class=''><h1 id='ml-분석--zeppelinpyspark-기반-적립카드-발급-대상-분석'><span>ML 분석 : Zeppelin/PySpark 기반 적립카드 발급 대상 분석</span></h1><blockquote><p><span>by Velucid </span>⏲<span>  June 04, 2021</span></p></blockquote><h4 id='topics'><span>Topics</span></h4><p><strong><span>OCI OKE(Oracle Kubernetes Engine) 따라하기</span></strong></p><ul><li><p><a href='./index.html' title='OCI OKE 따라하기: 주요 내용 요약'><span>주요 내용 요약</span></a></p></li><li><p><a href='./oci-oke-kubernetes-architecture.html' title='Kubernetes 아키텍처 및 주요 기능'><span>Kubernetes 아키텍처 및 주요 기능</span></a></p></li><li><p><strong><span>OCI OKE 운영을 위한 기본 환경 구성</span></strong></p><ul><li><a href='./oci-oke-k8s-cluster-provision.html' title='OKE(Oracle Kubernetes Engine) K8S Cluster 배포'><span>OKE(Oracle Kubernetes Engine) K8S Cluster 배포</span></a></li><li><a href='./oci-oke-api-key-registration.html' title='OCI API Key 등록'><span>OCI API Key 등록</span></a></li><li><a href='./oci-oke-bastion-server-creation.html' title='OKE 관리용 Bastion Server 구축'><span>OKE 관리용 Bastion Server 구축</span></a></li><li><a href='./oci-oke-oci-cli-setup.html' title='OCI CLI 설치 및 OCI Endpoint 연동'><span>OCI CLI 설치 및 OCI Endpoint 연동</span></a></li><li><a href='./oci-oke-kubectl-setup.html' title='OCI OKE Cluster 접속 환경 설정'><span>OCI OKE Cluster 접속 환경 설정</span></a></li></ul></li><li><p><strong><span>OCI OKE에 애플리케이션 배포하기</span></strong></p><ul><li><a href='./oci-oke-oci-registry.html' title='OCI Registry: Container Image 등록 및 안전한 배포'><span>OCI Registry: Container Image 등록 및 안전한 배포</span></a></li><li><a href='./oci-oke-k8s-lb-guestbook-mongodb.html' title='MongoDB 기반 방명록(PHP) 애플리케이션 배포'><span>MongoDB 기반 방명록(PHP) 애플리케이션 배포</span></a></li><li><strong><span>NEW</span></strong><span> </span><a href='./oci-oke-zeppelin-pyspark.html' title='ML 분석 : Zeppelin/PySpark 구성 및 배포'><span>ML 분석 : Zeppelin/PySpark 구성 및 배포</span></a><span>​</span></li><li><strong><span>NEW</span></strong><span> </span><a href='./oci-oke-ml-affinity-card.html' title='ML 분석 : Zeppelin/PySpark 기반 적립카드 발급 대상 분석'><span>ML 분석 : Zeppelin/PySpark 기반 적립카드 발급 대상 분석</span></a></li><li><span>TBD : OCI Block Volume을 통한 Persistent Volume 구축</span></li><li><span>TBD : OCI Autonomous Database와의 안전한 연결 구축</span></li></ul></li></ul><hr /><h3 id='내용-설명'><span>내용 설명</span></h3><p><span>Apache Zeppelin Docker Image를 기반으로 5 개의 머신 러닝 학습을 수행하는 과정을 보여드립니다.</span></p><h4 id='적립-카드-발급-대상-ml-모델-생성-과정'><span>적립 카드 발급 대상 ML 모델 생성 과정</span></h4><p><span>전체 ML 모델 생성 및 학습 과정은 Python을 기반으로 수행되며, 이를 수행하는 인터페이스는 Apache Zeppelin이 사용됩니다. Apache Zeppelin 최신 Docker Image에는 Zeppelin 이외에도 Python, Spark 분산 분석 환경이 함께 설치되어 있기 때문에, 손쉰게 GUI 인터페이스를 통해 ML 실습이 가능합니다.</span></p><ul><li><p><span>적립 카드 데이터 로딩 : Web 상의 적립 카드 데이터를 pyspark의 Panda DataFrame으로 로딩 </span></p><ul><li><a href='https://velucid.github.io/oci/oke/data/sales_affinity_card.csv' target='_blank' class='url'>https://velucid.github.io/oci/oke/data/sales_affinity_card.csv</a></li></ul></li><li><p><span>ML 분석 환경 : Zeppeline의 pyspark를 통해 스크립트 작성</span></p></li><li><p><span>데이터 벡터화 및 분리</span></p><ul><li><span>DataFrame의 데이터를 숫자 벡터로 변환</span></li><li><span>7:3으로 학습용과 테스트용 데이터로 분리</span></li></ul></li><li><p><span>머신 러닝 학습, 모델 생성 및 평가</span></p><ul><li><span>학습용 데이터를 기반으로 5 개의 ML 알고리즘으로 적립 카드 발급 대상을 학습</span></li><li><span>학습된 모델의 성능(예측치) 측정</span></li></ul></li><li><p><span>최적 모델 선정</span></p><ul><li><span>각 ML 알고리즘의 학습 성능을 비교 분석하여 최고의 예측치를 가지는 모델 선정</span></li></ul></li></ul><p><img src="images/ai-ml/oci-oke-ml-training-flow.png" referrerpolicy="no-referrer" alt="ML Process" title="ML Process"></p><h4 id='적립-카드-데이터-정보'><span>적립 카드 데이터 정보</span></h4><p><span>적립 카드 데이터는 사용자의 구매 이력 데이터로서 다음과 같은 컬럼을 포함합니다.</span></p><ul><li><span>적립 카드 발행 여부</span></li><li><span>나이, 성별, 직업 및 수입 수준</span></li><li><span>동거 가족 수 , 주거 기간, 지역</span></li><li><span>구매 물품 정보 및 가격</span></li></ul><p><span>본 예제의 핵심은 적립 카드를 사용중인 구매자의 다양한 정보를 기반으로 &quot;적립 카드 발급 대상&quot;을 학습 시키는 것이며, 이를 기반으로 신규 사용자나 기존 사용자에게 &quot;적립 카드 발급&quot; 프로모션을 수행하는 것입니다.</span></p><p><span>다음은 Oracle Autonomous Database에 해당 데이터을 로딩한 후, Zeppelin을 통해 질의한 결과를 보여줍니다.</span></p><p><img src="images/ai-ml/oci-oke-affinity-card-table.png" referrerpolicy="no-referrer" alt="Affinity Card Table" title="Affinity Card Table"></p><p><span>%adw는 Zeppelin에 수동으로 등록한 Oracle Autonomous Database와 연동하여 jdbc 질의를 수행하는 인터프리터입니다.</span></p><p><span>Oracle Autonomous Database가 제공하는 분석 함수인 Exaplain을 수행하면 다음과 같이 해당 테이블의 컬럼간의 연관성을 알 수 있습니다.</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="sql" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><span><span>​</span>x</span></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">%</span>adw</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">BEGIN</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">-- 결과 테이블 초기화</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">BEGIN</span> <span class="cm-keyword">EXECUTE</span> IMMEDIATE <span class="cm-string">'DROP TABLE sales_affinity_card_explain'</span><span class="cm-punctuation">;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  EXCEPTION <span class="cm-keyword">WHEN</span> OTHERS <span class="cm-keyword">THEN</span> <span class="cm-atom">NULL</span><span class="cm-punctuation">;</span> <span class="cm-keyword">END</span><span class="cm-punctuation">;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">-- 오라클 Advanced Analytics의 Explan 사용</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">-- MDL(Minimum Description Length) 기반 Attribute Importance 산출</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  DBMS_PREDICTIVE_ANALYTICS<span class="cm-variable-2">.EXPLAIN</span><span class="cm-bracket">(</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  data_table_name &nbsp; &nbsp; <span class="cm-operator">=&gt;</span> <span class="cm-string">'ext_sales_affinity_card'</span><span class="cm-punctuation">,</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  explain_column_name <span class="cm-operator">=&gt;</span> <span class="cm-string">'affinity_card'</span><span class="cm-punctuation">,</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  result_table_name &nbsp; <span class="cm-operator">=&gt;</span> <span class="cm-string">'sales_affinity_card_explain'</span><span class="cm-bracket">)</span><span class="cm-punctuation">;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">END</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 322px;"></div><div class="CodeMirror-gutters" style="display: none; height: 322px;"></div></div></div></pre><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">%</span>adw</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">-- 연관도가 0 보다 큰 Attribute 질의</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">select</span> rank<span class="cm-punctuation">,</span> trunc<span class="cm-bracket">(</span>explanatory_value<span class="cm-operator">*</span><span class="cm-number">100</span><span class="cm-punctuation">,</span><span class="cm-number">0</span><span class="cm-bracket">)</span> <span class="cm-keyword">as</span> explanatory<span class="cm-punctuation">,</span> attribute_name</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> sales_affinity_card_explain</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">order</span> <span class="cm-keyword">by</span> rank</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 115px;"></div><div class="CodeMirror-gutters" style="display: none; height: 115px;"></div></div></div></pre><p><img src="images/ai-ml/oci-oke-affinity-card-explain.png" referrerpolicy="no-referrer" alt="Explain" title="Explain"></p><p><span>위의 결과로 알 수 있듯이, 적립카드 발행 여부는 &quot;가족 수&quot;, &quot;결혼 여부&quot;, &quot;나이&quot;, &quot;거주 년수&quot;, &quot;직업&quot;, &quot;성별&quot; 순으로 연관도가 높은 것을 알 수 있습니다. 그러므로, 이 들 컬럼을 중점적으로 분석해야만 적립 카드 ML 분석에 더 정확한 결과를 얻을 수 있습니다.</span></p><blockquote><p><span>Zeppelin과 OCI Autonomous Database와 연결은 하기 그림과 같이 Zeppelin의 인터페이스 등록을 통해 가능합니다. ADW의 Wallet을 다운 받아, Zeppelin 인스턴스에 저장한 후, 이를 default.url의 TNS_ADMIN으로 지정해야 합니다. </span></p></blockquote><p><img src="images/ai-ml/oci-oke-adw-zeppelin.png" referrerpolicy="no-referrer" alt="Adw Zeppelin" title="Adw Zeppelin"></p><h4 id='1-적립-카드-데이터-로딩-csv--panda-dataframe'><span>1) 적립 카드 데이터 로딩 (CSV &gt; Panda DataFrame)</span></h4><ul><li><span>수행 코드</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">pyspark</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">pandas</span> <span class="cm-keyword">as</span> <span class="cm-variable">pd</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span> <span class="cm-keyword">import</span> <span class="cm-variable">SparkFiles</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 적립 카드 정보 (.csv)를 DataFrame으로 전환</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">spark</span>.<span class="cm-property">sparkContext</span>.<span class="cm-property">addFile</span>(<span class="cm-string">"https://velucid.github.io/oci/oke/data/sales_affinity_card.csv"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df</span> = <span class="cm-variable">spark</span>.<span class="cm-property">read</span>.<span class="cm-property">csv</span>(<span class="cm-string">"file://"</span><span class="cm-operator">+</span><span class="cm-variable">SparkFiles</span>.<span class="cm-property">get</span>(<span class="cm-string">"sales_affinity_card.csv"</span>), <span class="cm-variable">header</span>=<span class="cm-keyword">True</span>, <span class="cm-variable">inferSchema</span>= <span class="cm-keyword">True</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 획득한 데이터 정보 출력</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df</span>.<span class="cm-property">printSchema</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df</span>.<span class="cm-property">select</span>(<span class="cm-string">"REC_NO"</span>, <span class="cm-string">"AFFINITY_CARD"</span>, <span class="cm-string">"AGE"</span>, <span class="cm-string">"CUST_MARITAL_STATUS"</span>, <span class="cm-string">"HOUSEHOLD_SIZE"</span>, <span class="cm-string">"YRS_RESIDENCE"</span>).<span class="cm-property">show</span>(<span class="cm-number">5</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 345px;"></div><div class="CodeMirror-gutters" style="display: none; height: 345px;"></div></div></div></pre><ul><li><span>수행 결과</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="sql" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">root</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">|--</span> REC_NO<span class="cm-punctuation">:</span> <span class="cm-builtin">integer</span> <span class="cm-bracket">(</span>nullable <span class="cm-operator">=</span> <span class="cm-atom">true</span><span class="cm-bracket">)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">|--</span> AFFINITY_CARD<span class="cm-punctuation">:</span> <span class="cm-builtin">integer</span> <span class="cm-bracket">(</span>nullable <span class="cm-operator">=</span> <span class="cm-atom">true</span><span class="cm-bracket">)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">|--</span> CUST_GENDER<span class="cm-punctuation">:</span> string <span class="cm-bracket">(</span>nullable <span class="cm-operator">=</span> <span class="cm-atom">true</span><span class="cm-bracket">)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">|--</span> AGE<span class="cm-punctuation">:</span> <span class="cm-builtin">integer</span> <span class="cm-bracket">(</span>nullable <span class="cm-operator">=</span> <span class="cm-atom">true</span><span class="cm-bracket">)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">|--</span> OCCUPATION<span class="cm-punctuation">:</span> string <span class="cm-bracket">(</span>nullable <span class="cm-operator">=</span> <span class="cm-atom">true</span><span class="cm-bracket">)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">|--</span> CUST_INCOME_LEVEL<span class="cm-punctuation">:</span> string <span class="cm-bracket">(</span>nullable <span class="cm-operator">=</span> <span class="cm-atom">true</span><span class="cm-bracket">)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">|--</span> CUST_MARITAL_STATUS<span class="cm-punctuation">:</span> string <span class="cm-bracket">(</span>nullable <span class="cm-operator">=</span> <span class="cm-atom">true</span><span class="cm-bracket">)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">|--</span> HOUSEHOLD_SIZE<span class="cm-punctuation">:</span> string <span class="cm-bracket">(</span>nullable <span class="cm-operator">=</span> <span class="cm-atom">true</span><span class="cm-bracket">)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">|--</span> YRS_RESIDENCE<span class="cm-punctuation">:</span> <span class="cm-builtin">integer</span> <span class="cm-bracket">(</span>nullable <span class="cm-operator">=</span> <span class="cm-atom">true</span><span class="cm-bracket">)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">|--</span> PROD_NAME<span class="cm-punctuation">:</span> string <span class="cm-bracket">(</span>nullable <span class="cm-operator">=</span> <span class="cm-atom">true</span><span class="cm-bracket">)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">|--</span> PROD_CATEGORY<span class="cm-punctuation">:</span> string <span class="cm-bracket">(</span>nullable <span class="cm-operator">=</span> <span class="cm-atom">true</span><span class="cm-bracket">)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">|--</span> PROD_SUBCATEGORY<span class="cm-punctuation">:</span> string <span class="cm-bracket">(</span>nullable <span class="cm-operator">=</span> <span class="cm-atom">true</span><span class="cm-bracket">)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">|--</span> PROD_LIST_PRICE<span class="cm-punctuation">:</span> <span class="cm-builtin">double</span> <span class="cm-bracket">(</span>nullable <span class="cm-operator">=</span> <span class="cm-atom">true</span><span class="cm-bracket">)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">|--</span> QUANTITY_SOLD<span class="cm-punctuation">:</span> <span class="cm-builtin">integer</span> <span class="cm-bracket">(</span>nullable <span class="cm-operator">=</span> <span class="cm-atom">true</span><span class="cm-bracket">)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">|--</span> AMOUNT_SOLD<span class="cm-punctuation">:</span> <span class="cm-builtin">double</span> <span class="cm-bracket">(</span>nullable <span class="cm-operator">=</span> <span class="cm-atom">true</span><span class="cm-bracket">)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">|--</span> COUNTRY_NAME<span class="cm-punctuation">:</span> string <span class="cm-bracket">(</span>nullable <span class="cm-operator">=</span> <span class="cm-atom">true</span><span class="cm-bracket">)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+------+-------------+---+-------------------+--------------+-------------+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">|</span>REC_NO<span class="cm-operator">|</span>AFFINITY_CARD<span class="cm-operator">|</span>AGE<span class="cm-operator">|</span>CUST_MARITAL_STATUS<span class="cm-operator">|</span>HOUSEHOLD_SIZE<span class="cm-operator">|</span>YRS_RESIDENCE<span class="cm-operator">|</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+------+-------------+---+-------------------+--------------+-------------+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">|</span> &nbsp; &nbsp; <span class="cm-number">1</span><span class="cm-operator">|</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span><span class="cm-operator">|</span> <span class="cm-number">62</span><span class="cm-operator">|</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Widowed<span class="cm-operator">|</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">2</span><span class="cm-operator">|</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">3</span><span class="cm-operator">|</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">|</span> &nbsp; &nbsp; <span class="cm-number">2</span><span class="cm-operator">|</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span><span class="cm-operator">|</span> <span class="cm-number">34</span><span class="cm-operator">|</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NeverM<span class="cm-operator">|</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">2</span><span class="cm-operator">|</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">6</span><span class="cm-operator">|</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">|</span> &nbsp; &nbsp; <span class="cm-number">3</span><span class="cm-operator">|</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span><span class="cm-operator">|</span> <span class="cm-number">34</span><span class="cm-operator">|</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NeverM<span class="cm-operator">|</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">2</span><span class="cm-operator">|</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">6</span><span class="cm-operator">|</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">|</span> &nbsp; &nbsp; <span class="cm-number">4</span><span class="cm-operator">|</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span><span class="cm-operator">|</span> <span class="cm-number">50</span><span class="cm-operator">|</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Divorc.<span class="cm-operator">|</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">2</span><span class="cm-operator">|</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">5</span><span class="cm-operator">|</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">|</span> &nbsp; &nbsp; <span class="cm-number">5</span><span class="cm-operator">|</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span><span class="cm-operator">|</span> <span class="cm-number">40</span><span class="cm-operator">|</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Divorc.<span class="cm-operator">|</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">2</span><span class="cm-operator">|</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">5</span><span class="cm-operator">|</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+------+-------------+---+-------------------+--------------+-------------+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">only showing top <span class="cm-number">5</span> rows</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 667px;"></div><div class="CodeMirror-gutters" style="display: none; height: 667px;"></div></div></div></pre><h4 id='2-적립-카드-데이터-3d-분석-matplot-3d'><span>2) 적립 카드 데이터 3D 분석 (Matplot 3D)</span></h4><ul><li><span>수행 코드</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">pyspark</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">matplotlib</span> <span class="cm-keyword">as</span> <span class="cm-variable">mpl</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">mpl_toolkits</span>.<span class="cm-property">mplot3d</span> <span class="cm-keyword">import</span> <span class="cm-variable">Axes3D</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">matplotlib</span>.<span class="cm-property">pyplot</span> <span class="cm-keyword">as</span> <span class="cm-variable">plt</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span> = <span class="cm-variable">df</span>.<span class="cm-property">collect</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">CUST_MARITAL_STATUS</span> = {<span class="cm-string">'Mar-AF'</span>: <span class="cm-number">1</span>, <span class="cm-string">'Mabsent'</span>: <span class="cm-number">2</span>, <span class="cm-string">'Divorc.'</span>: <span class="cm-number">3</span>, <span class="cm-string">'Married'</span>: <span class="cm-number">4</span>, <span class="cm-string">'NeverM'</span>: <span class="cm-number">5</span>, <span class="cm-string">'Separ.'</span>: <span class="cm-number">6</span>, <span class="cm-string">'Widowed'</span>: <span class="cm-number">7</span>}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">HOUSEHOLD_SIZE</span> = {<span class="cm-string">'1'</span>: <span class="cm-number">1</span>, <span class="cm-string">'2'</span>: <span class="cm-number">2</span>, <span class="cm-string">'3'</span>: <span class="cm-number">3</span>, <span class="cm-string">'4-5'</span>: <span class="cm-number">4</span>, <span class="cm-string">'9+'</span>: <span class="cm-number">5</span>, <span class="cm-string">'6-8'</span>: <span class="cm-number">6</span> }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">x3d1</span>, <span class="cm-variable">y3d1</span>, <span class="cm-variable">z3d1</span>, <span class="cm-variable">x3d2</span>, <span class="cm-variable">y3d2</span>, <span class="cm-variable">z3d2</span> = [], [], [], [], [], []</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">r</span> <span class="cm-keyword">in</span> <span class="cm-variable">data</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">if</span> <span class="cm-builtin">int</span>(<span class="cm-variable">r</span>[<span class="cm-string">'AFFINITY_CARD'</span>]) == <span class="cm-number">0</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">x3d1</span>.<span class="cm-property">append</span>(<span class="cm-variable">CUST_MARITAL_STATUS</span>[<span class="cm-variable">r</span>[<span class="cm-string">'CUST_MARITAL_STATUS'</span>]])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">y3d1</span>.<span class="cm-property">append</span>(<span class="cm-variable">HOUSEHOLD_SIZE</span>[<span class="cm-variable">r</span>[<span class="cm-string">'HOUSEHOLD_SIZE'</span>]])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">z3d1</span>.<span class="cm-property">append</span>(<span class="cm-builtin">int</span>(<span class="cm-variable">r</span>[<span class="cm-string">'AGE'</span>]))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">else</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">x3d2</span>.<span class="cm-property">append</span>(<span class="cm-variable">CUST_MARITAL_STATUS</span>[<span class="cm-variable">r</span>[<span class="cm-string">'CUST_MARITAL_STATUS'</span>]])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">y3d2</span>.<span class="cm-property">append</span>(<span class="cm-variable">HOUSEHOLD_SIZE</span>[<span class="cm-variable">r</span>[<span class="cm-string">'HOUSEHOLD_SIZE'</span>]])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">z3d2</span>.<span class="cm-property">append</span>(<span class="cm-builtin">int</span>(<span class="cm-variable">r</span>[<span class="cm-string">'AGE'</span>]))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ax</span> = <span class="cm-variable">plt</span>.<span class="cm-property">subplot</span>(<span class="cm-number">111</span>, <span class="cm-variable">projection</span>=<span class="cm-string">'3d'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ax</span>.<span class="cm-property">plot</span>(<span class="cm-variable">x3d1</span>,<span class="cm-variable">y3d1</span>,<span class="cm-variable">z3d1</span>,<span class="cm-string">'o'</span>,<span class="cm-variable">color</span>=<span class="cm-string">'r'</span>, <span class="cm-variable">label</span>=<span class="cm-string">'affinity_card'</span>, <span class="cm-variable">alpha</span>=<span class="cm-number">0.2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ax</span>.<span class="cm-property">plot</span>(<span class="cm-variable">x3d2</span>,<span class="cm-variable">y3d2</span>,<span class="cm-variable">z3d2</span>,<span class="cm-string">'o'</span>,<span class="cm-variable">color</span>=<span class="cm-string">'b'</span>, <span class="cm-variable">label</span>=<span class="cm-string">'no_card'</span>, <span class="cm-variable">alpha</span>=<span class="cm-number">0.2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">legend</span>(<span class="cm-variable">loc</span>=<span class="cm-string">'upper center'</span>, <span class="cm-variable">numpoints</span>=<span class="cm-number">1</span>, <span class="cm-variable">ncol</span>=<span class="cm-number">3</span>, <span class="cm-variable">fontsize</span>=<span class="cm-number">10</span>, <span class="cm-variable">bbox_to_anchor</span>=(<span class="cm-number">0.5</span>, <span class="cm-number">1.05</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">xlabel</span>(<span class="cm-string">"CUST_MARITAL_STATUS"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">ylabel</span>(<span class="cm-string">"HOUSEHOLD_SIZE"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ax</span>.<span class="cm-property">set_zlabel</span>(<span class="cm-string">"AGE"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">z</span>.<span class="cm-property">show</span>(<span class="cm-variable">plt</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">close</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 759px;"></div><div class="CodeMirror-gutters" style="display: none; height: 759px;"></div></div></div></pre><ul><li><span>수행 결과</span></li></ul><p><img src="images/ai-ml/oci-oke-matplot3d.png" referrerpolicy="no-referrer" alt="Matplot3d" title="Matplot3d"></p><h3 id='데이터-벡터화-전처리의-필요성'><span>데이터 벡터화, 전처리의 필요성</span></h3><p><span>대부분의 머신러닝 알고리즘은 숫자 정보를 입력 데이터로 사용합니다. 이를 위해서는 텍스트와 비디오와 같은 비정형 데이터를 ML 알고리즘이 인식할 수 있는 숫자 정보 집합으로 변환하는 전처리를 수행해야 합니다.</span></p><p><img src="images/ai-ml/oci-oke-vector.png" referrerpolicy="no-referrer" alt="Vectorinzing" title="Vectorinzing"></p><h4 id='3-1-분석-테이블-데이터-전처리-벡터숫자-정보-집합로-변환'><span>3-1) 분석 테이블 데이터 전처리: 벡터(숫자 정보 집합)로 변환</span></h4><ul><li><span>수행 코드</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">pyspark</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span>.<span class="cm-property">feature</span> <span class="cm-keyword">import</span> <span class="cm-variable">OneHotEncoderEstimator</span>, <span class="cm-variable">StringIndexer</span>, <span class="cm-variable">VectorAssembler</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span> <span class="cm-keyword">import</span> <span class="cm-variable">Pipeline</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">pandas</span> <span class="cm-keyword">as</span> <span class="cm-variable">pd</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">cols</span> = <span class="cm-variable">df</span>.<span class="cm-property">columns</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">stages</span> = []</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 텍스트 컴럼에 대한 벡터 변환</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">categoricalColumns</span> = [<span class="cm-string">"CUST_GENDER"</span>, <span class="cm-string">"HOUSEHOLD_SIZE"</span>, <span class="cm-string">"CUST_MARITAL_STATUS"</span>, <span class="cm-string">"OCCUPATION"</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">categoricalCol</span> <span class="cm-keyword">in</span> <span class="cm-variable">categoricalColumns</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">stringIndexer</span> = <span class="cm-variable">StringIndexer</span>(<span class="cm-variable">inputCol</span>=<span class="cm-variable">categoricalCol</span>, <span class="cm-variable">outputCol</span>=<span class="cm-variable">categoricalCol</span> <span class="cm-operator">+</span> <span class="cm-string">"Index"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">encoder</span> = <span class="cm-variable">OneHotEncoderEstimator</span>(<span class="cm-variable">inputCols</span>=[<span class="cm-variable">stringIndexer</span>.<span class="cm-property">getOutputCol</span>()], <span class="cm-variable">outputCols</span>=[<span class="cm-variable">categoricalCol</span> <span class="cm-operator">+</span> <span class="cm-string">"classVec"</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">stages</span> += [<span class="cm-variable">stringIndexer</span>, <span class="cm-variable">encoder</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#레이블 컬럼 지정: 학습 대상 컬럼</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">label_stringIdx</span> = <span class="cm-variable">StringIndexer</span>(<span class="cm-variable">inputCol</span> = <span class="cm-string">'AFFINITY_CARD'</span>, <span class="cm-variable">outputCol</span> = <span class="cm-string">'label'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">stages</span> += [<span class="cm-variable">label_stringIdx</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 원래 숫자 컬럼 명시</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">numericCols</span> = [<span class="cm-string">'AGE'</span>, <span class="cm-string">'YRS_RESIDENCE'</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">assemblerInputs</span> = [<span class="cm-variable">c</span> <span class="cm-operator">+</span> <span class="cm-string">"classVec"</span> <span class="cm-keyword">for</span> <span class="cm-variable">c</span> <span class="cm-keyword">in</span> <span class="cm-variable">categoricalColumns</span>] <span class="cm-operator">+</span> <span class="cm-variable">numericCols</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">assembler</span> = <span class="cm-variable">VectorAssembler</span>(<span class="cm-variable">inputCols</span>=<span class="cm-variable">assemblerInputs</span>, <span class="cm-variable">outputCol</span>=<span class="cm-string">"features"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">stages</span> += [<span class="cm-variable">assembler</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">pipeline</span> = <span class="cm-variable">Pipeline</span>(<span class="cm-variable">stages</span> = <span class="cm-variable">stages</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">pipelineModel</span> = <span class="cm-variable">pipeline</span>.<span class="cm-property">fit</span>(<span class="cm-variable">df</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df</span> = <span class="cm-variable">pipelineModel</span>.<span class="cm-property">transform</span>(<span class="cm-variable">df</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">selectedCols</span> = [<span class="cm-string">'label'</span>, <span class="cm-string">'features'</span>] <span class="cm-operator">+</span> <span class="cm-variable">cols</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df2</span> = <span class="cm-variable">df</span>.<span class="cm-property">select</span>(<span class="cm-variable">selectedCols</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df2</span>.<span class="cm-property">select</span>(<span class="cm-string">"label"</span>,<span class="cm-string">"features"</span>,<span class="cm-string">"REC_NO"</span>).<span class="cm-property">show</span>(<span class="cm-number">10</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 782px;"></div><div class="CodeMirror-gutters" style="display: none; height: 782px;"></div></div></div></pre><ul><li><span>수행 결과</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+-----+--------------------+------+</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|label| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  features|REC_NO|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+-----+--------------------+------+</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0|(27,[2,9,15,25,26...| &nbsp; &nbsp; 1|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0|(27,[0,2,7,14,25,...| &nbsp; &nbsp; 2|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0|(27,[0,2,7,14,25,...| &nbsp; &nbsp; 3|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0|(27,[2,8,14,25,26...| &nbsp; &nbsp; 4|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0|(27,[2,8,16,25,26...| &nbsp; &nbsp; 5|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  1.0|(27,[0,1,6,12,25,...| &nbsp; &nbsp; 6|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0|(27,[0,1,6,19,25,...| &nbsp; &nbsp; 7|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0|(27,[0,1,6,19,25,...| &nbsp; &nbsp; 8|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0|(27,[2,8,17,25,26...| &nbsp; &nbsp; 9|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0|(27,[4,8,15,25,26...| &nbsp;  10|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+-----+--------------------+------+</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">only showing top 10 rows</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 345px;"></div><div class="CodeMirror-gutters" style="display: none; height: 345px;"></div></div></div></pre><p>&nbsp;</p><h3 id='분석-테이블-데이터-전처리-벡터숫자-정보-집합로-변환'><span>분석 테이블 데이터 전처리: 벡터(숫자 정보 집합)로 변환</span></h3><p><span>머신 러닝 학습 과정에서 입력 데이터는 보통 7:3으로 분리되어 학습용과 교차 검증용으로 사용됩니다.</span></p><p><img src="images/ai-ml/oci-oke-data-split.png" referrerpolicy="no-referrer" alt="Data Split" title="Data Split"></p><h4 id='3-2-분석-대상-데이터-분리-학습-테스트용'><span>3-2) 분석 대상 데이터 분리 (학습, 테스트용)</span></h4><ul><li><span>수행 코드</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">pyspark</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">pandas</span> <span class="cm-keyword">as</span> <span class="cm-variable">pd</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">train</span>, <span class="cm-variable">test</span> = <span class="cm-variable">df2</span>.<span class="cm-property">randomSplit</span>([<span class="cm-number">0.7</span>, <span class="cm-number">0.3</span>], <span class="cm-variable">seed</span> = <span class="cm-number">2018</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"Training Dataset Count: "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">train</span>.<span class="cm-property">count</span>()))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">train</span>.<span class="cm-property">select</span>(<span class="cm-string">"features"</span>, <span class="cm-string">"AFFINITY_CARD"</span>, <span class="cm-string">"HOUSEHOLD_SIZE"</span>, <span class="cm-string">"YRS_RESIDENCE"</span>, <span class="cm-string">"CUST_MARITAL_STATUS"</span>).<span class="cm-property">show</span>(<span class="cm-number">2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"Test Dataset Count: "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">test</span>.<span class="cm-property">count</span>()))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">test</span>.<span class="cm-property">select</span>(<span class="cm-string">"features"</span>, <span class="cm-string">"AFFINITY_CARD"</span>, <span class="cm-string">"HOUSEHOLD_SIZE"</span>, <span class="cm-string">"YRS_RESIDENCE"</span>, <span class="cm-string">"CUST_MARITAL_STATUS"</span>).<span class="cm-property">show</span>(<span class="cm-number">2</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 322px;"></div><div class="CodeMirror-gutters" style="display: none; height: 322px;"></div></div></div></pre><ul><li><span>수행 결과</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Training Dataset Count: 2001</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+--------------------+-------------+--------------+-------------+-------------------+</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  features|AFFINITY_CARD|HOUSEHOLD_SIZE|YRS_RESIDENCE|CUST_MARITAL_STATUS|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+--------------------+-------------+--------------+-------------+-------------------+</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|(27,[0,1,6,12,25,...| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  0| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  2| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|(27,[0,1,6,12,25,...| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  0| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  2| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+--------------------+-------------+--------------+-------------+-------------------+</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">only showing top 2 rows</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Test Dataset Count: 803</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+--------------------+-------------+--------------+-------------+-------------------+</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  features|AFFINITY_CARD|HOUSEHOLD_SIZE|YRS_RESIDENCE|CUST_MARITAL_STATUS|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+--------------------+-------------+--------------+-------------+-------------------+</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|(27,[0,1,6,12,25,...| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  0| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|(27,[0,1,6,12,25,...| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  0| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+--------------------+-------------+--------------+-------------+-------------------+</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">only showing top 2 rows</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 667px;"></div><div class="CodeMirror-gutters" style="display: none; height: 667px;"></div></div></div></pre><h3 id='ml-알고리즘-소개--regression과-classification의-관계'><span>ML 알고리즘 소개 : Regression과 Classification의 관계</span></h3><p><span>회귀(Regression)와 분류(Classification)는 </span><font color='red'><span>결과가 정해진 데이터</span></font><span>를 학습하는 </span><font color='red'><span>지도(Supervied) 학습의 대표적인 두 가지 유형</span></font><span>입니다.</span></p><p><span>다양한 ML 분석 알고리즘들에 </span><font color='red'><span>연계되어 두루 사용</span></font><span>되고 있습니다. 예를 들어 SVM의 경우, 분류와 회귀는 물론 이상치 검출에도 사용됩니다.</span></p><figure><table><thead><tr><th><span>Regression(회귀)</span></th><th><span>Classification (분류)</span></th></tr></thead><tbody><tr><td><img src="http://velucid.github.io/oci/oke/images/ai-ml/oci-oke-regression.png" referrerpolicy="no-referrer" alt="Regression"></td><td><img src="http://velucid.github.io/oci/oke/images/ai-ml/oci-oke-classification.png" referrerpolicy="no-referrer" alt="Classification"></td></tr><tr><td><span>평균과 같은 </span><font color='red'><span>일정한 값으로 돌아가려는 경향</span></font><span>을 이용한 통계학 기법</span></td><td><span>데이터가 </span><font color='red'><span>어떤 종류(레이블)에 속하는지 분류</span></font><span>해주는 학습 모델</span></td></tr><tr><td><span>실제값과 예측값의 차이(Residual)를 </span><font color='red'><span>최소화 하는 회귀선</span></font><span>을 찾아 예측에 사용</span></td><td><span>다양한 알고리즘(회귀 포함)을 통해 </span><font color='red'><span>레이블을 최적으로 분리하는 경계</span></font><span>를 찾아냄</span></td></tr><tr><td><span>예측 값으로 </span><font color='red'><span>연속형 숫자</span></font><span> 값이 사용됨</span></td><td><span>예측 값으로 </span><font color='red'><span>카테고리/레이블과 같은 이산형 클래스</span></font><span>가 사용됨</span></td></tr><tr><td><span>선형/비선형 회귀, 다항식 회귀, 로지스틱 회귀, 릿지, 라쏘, 엘라스틱, 서포트 벡터 머신, 신경망</span></td><td><span>결정 트리, CART,  K-NN, 로지스틱 회귀, 나이브 베이즈, 앙상블, 서포트 벡터 머신, 신경망</span></td></tr></tbody></table></figure><h3 id='ml-알고리즘-소개--linear-regression-선형-회귀의-중요성'><span>ML 알고리즘 소개 : Linear Regression (선형 회귀)의 중요성]</span></h3><figure><table><thead><tr><th><span>다양한 회귀 알고리즘</span></th><th><span>선형 회귀의 중요성</span></th></tr></thead><tbody><tr><td><img src="http://velucid.github.io/oci/oke/images/ai-ml/oci-oke-linear-regression.png" referrerpolicy="no-referrer" alt="Linear"></td><td><img src="http://velucid.github.io/oci/oke/images/ai-ml/oci-oke-linear-regression-why.png" referrerpolicy="no-referrer" alt="Why Linear"></td></tr><tr><td><span>선형 회귀는 </span><font color='red'><span>간편한 수식과 손쉬운 학습 방법</span></font><span>으로 가장 많이 사용됨</span></td><td><span>비선형 회귀는 </span><font color='red'><span>데이터의 특성</span></font><span>에 따라 선별적으로 사용됨</span></td></tr><tr><td><font color='red'><span>다항식 선형 회귀</span></font><span>는 직선에 비해 더 </span><font color='red'><span>정확한 결과</span></font><span>를 산출 하지만, </span><font color='red'><span>과적합 문제</span></font><span>를 유발할 수 있음</span></td><td><span>비선형 회귀도 차원 변환 등을 통해 </span><font color='red'><span>단순 선형 회귀</span></font><span>로 변환하여 활용 가능</span></td></tr></tbody></table></figure><h3 id='ml-알고리즘-소개--1-decision-tree결정-트리와-2-random-forest-classifier'><span>ML 알고리즘 소개 : 1) Decision Tree(결정 트리)와 2) Random Forest Classifier</span></h3><figure><table><thead><tr><th><span>결정 트리(Decision Tree) 모델을 이용한 아이리스 데이터 분류 결과</span></th><th><span>Random Forest를 통한 성능 향상</span></th></tr></thead><tbody><tr><td><img src="http://velucid.github.io/oci/oke/images/ai-ml/oci-oke-decision-tree-iris.png" referrerpolicy="no-referrer" alt="Decision Tree"></td><td><img src="http://velucid.github.io/oci/oke/images/ai-ml/oci-oke-random-forest-classifier-bagging.png" referrerpolicy="no-referrer" alt="Random Forest Classifier"></td></tr><tr><td><span>ML 알고리즘 중 가장 </span><font color='red'><span>직관적이고 이해하기 쉬우며 시각화가 용이</span></font><span>한 알고리즘</span></td><td><span>여러 분류기의 결과를 결합하여 분류하는 </span><font color='red'><span>앙상블(Ensemble)</span></font><span> 학습 모델</span></td></tr><tr><td><font color='red'><span>균일도가 높은</span></font><span> 데이터를 기준으로 </span><font color='red'><span>트리 구조로 분할</span></font><span>하여 분류 규칙을 찾아냄</span></td><td><span>데이터를 여러 개로 분리하여 </span><font color='red'><span>결정 트리 분류기를 병렬</span></font><span>로 적용하고</span></td></tr><tr><td><span>데이터의 스케일링과 정규화 같은 </span><font color='red'><span>전처리 작업</span></font><span>이 필요 없음</span></td><td><span>그 결과를 </span><font color='red'><span>투표를 통해 가장 많이 선택된 분류</span></font><span>를 최종 예측하는 방식</span></td></tr><tr><td><span>실제 상화에 맞는 </span><font color='red'><span>완벽한 규칙</span></font><span>의 생성이 어려움</span></td><td><font color='red'><span>데이터 분리 및 보팅</span></font><span>을 통해 과적합을 피하고 정확도를 높임</span></td></tr></tbody></table></figure><h4 id='4-1-decision-tree-classifier-분석-결과-77'><span>4-1) Decision Tree Classifier 분석 결과 (77%)</span></h4><ul><li><span>수행 코드</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">pyspark</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span>.<span class="cm-property">classification</span> <span class="cm-keyword">import</span> <span class="cm-variable">DecisionTreeClassifier</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span>.<span class="cm-property">evaluation</span> <span class="cm-keyword">import</span> <span class="cm-variable">BinaryClassificationEvaluator</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">dt</span> = <span class="cm-variable">DecisionTreeClassifier</span>(<span class="cm-variable">featuresCol</span> = <span class="cm-string">'features'</span>, <span class="cm-variable">labelCol</span> = <span class="cm-string">'label'</span>, <span class="cm-variable">maxDepth</span> = <span class="cm-number">5</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">dtModel</span> = <span class="cm-variable">dt</span>.<span class="cm-property">fit</span>(<span class="cm-variable">train</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">predictions</span> = <span class="cm-variable">dtModel</span>.<span class="cm-property">transform</span>(<span class="cm-variable">test</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">predictions</span>.<span class="cm-property">select</span>(<span class="cm-string">'label'</span>, <span class="cm-string">'prediction'</span>, <span class="cm-string">'probability'</span>, <span class="cm-string">'HOUSEHOLD_SIZE'</span>, <span class="cm-string">'YRS_RESIDENCE'</span>, <span class="cm-string">'CUST_MARITAL_STATUS'</span>).<span class="cm-property">show</span>(<span class="cm-number">5</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">evaluator</span> = <span class="cm-variable">BinaryClassificationEvaluator</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"Test Area Under ROC: "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">evaluator</span>.<span class="cm-property">evaluate</span>(<span class="cm-variable">predictions</span>, {<span class="cm-variable">evaluator</span>.<span class="cm-property">metricName</span>: <span class="cm-string">"areaUnderROC"</span>})))</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 345px;"></div><div class="CodeMirror-gutters" style="display: none; height: 345px;"></div></div></div></pre><ul><li><span>수행 결과</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.25px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+-----+----------+--------------------+--------------+-------------+-------------------+</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|label|prediction| &nbsp; &nbsp; &nbsp; &nbsp; probability|HOUSEHOLD_SIZE|YRS_RESIDENCE|CUST_MARITAL_STATUS|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+-----+----------+--------------------+--------------+-------------+-------------------+</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0| &nbsp; &nbsp; &nbsp; 0.0|[0.98795180722891...| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0| &nbsp; &nbsp; &nbsp; 0.0|[0.98795180722891...| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0| &nbsp; &nbsp; &nbsp; 0.0|[0.98795180722891...| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  1| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0| &nbsp; &nbsp; &nbsp; 1.0|[0.24137931034482...| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0| &nbsp; &nbsp; &nbsp; 1.0|[0.24137931034482...| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  5| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+-----+----------+--------------------+--------------+-------------+-------------------+</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">only showing top 5 rows</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 437px;"></div><div class="CodeMirror-gutters" style="display: none; height: 437px;"></div></div></div></pre><h4 id='4-2-random-forest-classifier-분석-결과-91'><span>4-2) Random Forest Classifier 분석 결과 (91%)</span></h4><ul><li><span>수행 코드</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">pyspark</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span>.<span class="cm-property">classification</span> <span class="cm-keyword">import</span> <span class="cm-variable">RandomForestClassifier</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span>.<span class="cm-property">evaluation</span> <span class="cm-keyword">import</span> <span class="cm-variable">BinaryClassificationEvaluator</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rf</span> = <span class="cm-variable">RandomForestClassifier</span>(<span class="cm-variable">featuresCol</span> = <span class="cm-string">'features'</span>, <span class="cm-variable">labelCol</span> = <span class="cm-string">'label'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rfModel</span> = <span class="cm-variable">rf</span>.<span class="cm-property">fit</span>(<span class="cm-variable">train</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">predictions</span> = <span class="cm-variable">rfModel</span>.<span class="cm-property">transform</span>(<span class="cm-variable">test</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">predictions</span>.<span class="cm-property">select</span>(<span class="cm-string">'label'</span>, <span class="cm-string">'prediction'</span>, <span class="cm-string">'probability'</span>, <span class="cm-string">'HOUSEHOLD_SIZE'</span>, <span class="cm-string">'YRS_RESIDENCE'</span>, <span class="cm-string">'CUST_MARITAL_STATUS'</span>).<span class="cm-property">show</span>(<span class="cm-number">5</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">evaluator</span> = <span class="cm-variable">BinaryClassificationEvaluator</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"Test Area Under ROC: "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">evaluator</span>.<span class="cm-property">evaluate</span>(<span class="cm-variable">predictions</span>, {<span class="cm-variable">evaluator</span>.<span class="cm-property">metricName</span>: <span class="cm-string">"areaUnderROC"</span>})))</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 322px;"></div><div class="CodeMirror-gutters" style="display: none; height: 322px;"></div></div></div></pre><ul><li><span>수행 결과</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.25px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+-----+----------+--------------------+--------------+-------------+-------------------+</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|label|prediction| &nbsp; &nbsp; &nbsp; &nbsp; probability|HOUSEHOLD_SIZE|YRS_RESIDENCE|CUST_MARITAL_STATUS|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+-----+----------+--------------------+--------------+-------------+-------------------+</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0| &nbsp; &nbsp; &nbsp; 0.0|[0.81623412903032...| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0| &nbsp; &nbsp; &nbsp; 0.0|[0.81623412903032...| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0| &nbsp; &nbsp; &nbsp; 0.0|[0.82027668222181...| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  1| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0| &nbsp; &nbsp; &nbsp; 0.0|[0.59621461334518...| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0| &nbsp; &nbsp; &nbsp; 1.0|[0.44262115423861...| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  5| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+-----+----------+--------------------+--------------+-------------+-------------------+</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">only showing top 5 rows</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Test Area Under ROC: 0.912622041160356</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 483px;"></div><div class="CodeMirror-gutters" style="display: none; height: 483px;"></div></div></div></pre><p>&nbsp;</p><h3 id='ml-알고리즘-소개--support-vector-machine'><span>ML 알고리즘 소개 : Support Vector Machine</span></h3><p><span>SVM은 선형 커널을 기본으로 복잡한 </span><font color='red'><span>비선형 문제</span></font><span>를 해결하기 위해 </span><font color='red'><span>다양한 Kernal 함수</span></font><span>를 제공합니다. 이는 분류에 보다 적합하도록 기존 데이터에 </span><font color='red'><span>차원 변환</span></font><span>을 가하는 것입니다.</span></p><ul><li><span>SVM Kernal Trick을 이용한 아이리스 분류 결과 </span><a href='https://dataaspirant.com/2017/01/25/svm-classifier-implemenation-python-scikit-learn/'><span>Link</span></a></li></ul><p><img src="http://velucid.github.io/oci/oke/images/ai-ml/oci-oke-svm-iris.png" referrerpolicy="no-referrer" alt="SVM"></p><h3 id='ml-알고리즘-소개--3-support-vector-machine-학습-모델'><span>ML 알고리즘 소개 : 3) Support Vector Machine 학습 모델</span></h3><figure><table><thead><tr><th><span>Support Vecor Machine: 초평면을 통한 분류</span></th><th><center><span>Kernel Trick을 통한 피처 변환</span></center></th></tr></thead><tbody><tr><td><img src="http://velucid.github.io/oci/oke/images/ai-ml/oci-oke-svm.png" referrerpolicy="no-referrer" alt="Support Vecor Machine"></td><td><img src="http://velucid.github.io/oci/oke/images/ai-ml/oci-oke-svm-kernel-tricks.png" referrerpolicy="no-referrer" alt="Kernel Trick"></td></tr><tr><td><span>Decision Boudary 분리에 필요한 </span><font color='red'><span>최소 개수의 Support Vector</span></font><span>으로 </span><font color='red'><span>최소한의 학습</span></font><span>만으로 Optimal Hyperplane을 찾습니다.</span></td><td><font color='red'><span>비선형 분석</span></font><span>을 위해서는(XOR 문제등) 고비용의 </span><font color='red'><span>고차원 피처 변환</span></font><span>이 필요한데,  </span><font color='red'><span>Kernal 함수</span></font><span>는 여기서 필요한 내적 연산을 대체하여 </span><font color='red'><span>변환 비용을 최소화</span></font><span> 합니다.</span></td></tr><tr><td><span>클래스간에 </span><font color='red'><span>가장 큰 마진(margin)</span></font><span>을 가지는 결정 경계를 찾아내어 </span><font color='red'><span>과적합</span></font><span>을 최소화합니다.</span></td><td><span>고차원 피처 변환이 필요한 다양한 분석(분류,회귀,이상치 검출)에 널리 활용되고 있습니다.</span></td></tr><tr><td><span>텍스트 및 이미지, 단백질 등의 분류에 탁월한 성능을 보입니다.</span></td><td><span>Kernal 함수: 선형, 동차, 다항식, 가우시안(RBF), 시그모이드(쌍곡탄젠트)</span></td></tr></tbody></table></figure><h4 id='4-3-linear-svm-분석-결과-83'><span>4-3) Linear SVM 분석 결과 (83%)</span></h4><ul><li><span>수행 코드</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">pyspark</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span>.<span class="cm-property">classification</span> <span class="cm-keyword">import</span> <span class="cm-variable">LinearSVC</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span>.<span class="cm-property">evaluation</span> <span class="cm-keyword">import</span> <span class="cm-variable">BinaryClassificationEvaluator</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">lsvc</span> = <span class="cm-variable">LinearSVC</span>(<span class="cm-variable">maxIter</span>=<span class="cm-number">10</span>, <span class="cm-variable">regParam</span>=<span class="cm-number">0.1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">lsvcModel</span> = <span class="cm-variable">lsvc</span>.<span class="cm-property">fit</span>(<span class="cm-variable">train</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">predictions</span> = <span class="cm-variable">lsvcModel</span>.<span class="cm-property">transform</span>(<span class="cm-variable">test</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">predictions</span>.<span class="cm-property">select</span>(<span class="cm-string">'label'</span>, <span class="cm-string">'prediction'</span>, <span class="cm-string">'HOUSEHOLD_SIZE'</span>, <span class="cm-string">'YRS_RESIDENCE'</span>, <span class="cm-string">'CUST_MARITAL_STATUS'</span>).<span class="cm-property">show</span>(<span class="cm-number">5</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">evaluator</span> = <span class="cm-variable">BinaryClassificationEvaluator</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"Test Area Under ROC: "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">evaluator</span>.<span class="cm-property">evaluate</span>(<span class="cm-variable">predictions</span>, {<span class="cm-variable">evaluator</span>.<span class="cm-property">metricName</span>: <span class="cm-string">"areaUnderROC"</span>})))</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 322px;"></div><div class="CodeMirror-gutters" style="display: none; height: 322px;"></div></div></div></pre><ul><li><span>수행 결과</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+-----+----------+--------------+-------------+-------------------+</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|label|prediction|HOUSEHOLD_SIZE|YRS_RESIDENCE|CUST_MARITAL_STATUS|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+-----+----------+--------------+-------------+-------------------+</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0| &nbsp; &nbsp; &nbsp; 0.0| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0| &nbsp; &nbsp; &nbsp; 0.0| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0| &nbsp; &nbsp; &nbsp; 0.0| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  1| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0| &nbsp; &nbsp; &nbsp; 0.0| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0| &nbsp; &nbsp; &nbsp; 0.0| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  5| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+-----+----------+--------------+-------------+-------------------+</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">only showing top 5 rows</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Test Area Under ROC: 0.8334533258411203</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 276px;"></div><div class="CodeMirror-gutters" style="display: none; height: 276px;"></div></div></div></pre><h3 id='ml-알고리즘-소개--4-logistic-regression'><span>[ML 알고리즘 소개 : 4) Logistic Regression]</span></h3><p><span>로지스틱 회귀는 </span><font color='red'><span>선형 회귀 방식을 분류에 적용</span></font><span>한 알고리즘입니다. 선형 함수 대신 자연, 사회 현상에서 자주 발생하는 </span><font color='red'><span>시그모이드 함수</span></font><span>를 사용합니다.  시그모이드 함수는 신경망에도 활성함수로 초기에 많이 사용되었습니다.</span></p><ol start='' ><li><font color='red'><span>회귀</span></font><span>: 데이터의 특성과 분포를 나타내는 최적의 시그모이드 곡선(로짓변환)을 찾고, </span></li><li><font color='red'><span>분류</span></font><span>: 이를 기준으로 상위와 하위로 분류합니다. </span></li><li><span>결과로 레이블 [0,1] 또는 숫자(0 ~ 1)을 모두 얻을 수 있습니다.</span></li></ol><p><img src="http://velucid.github.io/oci/oke/images/ai-ml/oci-oke-logistic-regression.png" referrerpolicy="no-referrer" alt="Lgistic Regression"></p><p><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9537e778e229470d85a68ee0b099c08298a1a3f6" referrerpolicy="no-referrer" alt="Lgistic Regression"></p><h4 id='4-4-logistic-regression-분석-결과-89'><span>4-4) Logistic Regression 분석 결과 (89%)</span></h4><ul><li><span>수행 코드</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">pyspark</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span>.<span class="cm-property">classification</span> <span class="cm-keyword">import</span> <span class="cm-variable">LogisticRegression</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span>.<span class="cm-property">evaluation</span> <span class="cm-keyword">import</span> <span class="cm-variable">BinaryClassificationEvaluator</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">lr</span> = <span class="cm-variable">LogisticRegression</span>(<span class="cm-variable">featuresCol</span> = <span class="cm-string">'features'</span>, <span class="cm-variable">labelCol</span> = <span class="cm-string">'label'</span>, <span class="cm-variable">maxIter</span>=<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">lrModel</span> = <span class="cm-variable">lr</span>.<span class="cm-property">fit</span>(<span class="cm-variable">train</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">predictions</span> = <span class="cm-variable">lrModel</span>.<span class="cm-property">transform</span>(<span class="cm-variable">test</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">predictions</span>.<span class="cm-property">select</span>(<span class="cm-string">'label'</span>, <span class="cm-string">'prediction'</span>, <span class="cm-string">'probability'</span>, <span class="cm-string">'HOUSEHOLD_SIZE'</span>, <span class="cm-string">'YRS_RESIDENCE'</span>, <span class="cm-string">'CUST_MARITAL_STATUS'</span>).<span class="cm-property">show</span>(<span class="cm-number">5</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">evaluator</span> = <span class="cm-variable">BinaryClassificationEvaluator</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"Test Area Under ROC: "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">evaluator</span>.<span class="cm-property">evaluate</span>(<span class="cm-variable">predictions</span>, {<span class="cm-variable">evaluator</span>.<span class="cm-property">metricName</span>: <span class="cm-string">"areaUnderROC"</span>})))</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 345px;"></div><div class="CodeMirror-gutters" style="display: none; height: 345px;"></div></div></div></pre><ul><li><span>수행 결과</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.25px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+-----+----------+--------------------+--------------+-------------+-------------------+</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|label|prediction| &nbsp; &nbsp; &nbsp; &nbsp; probability|HOUSEHOLD_SIZE|YRS_RESIDENCE|CUST_MARITAL_STATUS|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+-----+----------+--------------------+--------------+-------------+-------------------+</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0| &nbsp; &nbsp; &nbsp; 1.0|[0.43667953988177...| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0| &nbsp; &nbsp; &nbsp; 1.0|[0.43667953988177...| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0| &nbsp; &nbsp; &nbsp; 0.0|[0.64116044221858...| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  1| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0| &nbsp; &nbsp; &nbsp; 1.0|[0.44884795708763...| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0| &nbsp; &nbsp; &nbsp; 1.0|[0.26876020848898...| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  5| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+-----+----------+--------------------+--------------+-------------+-------------------+</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">only showing top 5 rows</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Test Area Under ROC: 0.892533539369249</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 483px;"></div><div class="CodeMirror-gutters" style="display: none; height: 483px;"></div></div></div></pre><h3 id='ml-알고리즘-소개--boosting-algorithm'><span>ML 알고리즘 소개 : Boosting Algorithm</span></h3><p><font color='red'><span>간단한 결정트리 분류기(약한 분류기)</span></font><span>로 먼저 분류한 후, 잘못 예측한 데이터를 가중치(+/-)를 주어 </span><font color='red'><span>오류를 보정/변경</span></font><span>하고, 이를 기반으로 </span><font color='red'><span>재분류</span></font><span>하는 과정을 순차적으로 반복하여 모델들을 학습시키는 </span><font color='red'><span>앙상블</span></font><span> 기법입니다. 오류 보정 방식이기에 </span><font color='red'><span>분류 효율이 상대적으로 좋으나</span></font><span> 순차적인 학습 과정때문에 </span><font color='red'><span>학습 시간이 오래 걸리고 과적합 오류를 유발</span></font><span>할 수 있습니다.</span></p><p><img src="http://velucid.github.io/oci/oke/images/ai-ml/oci-oke-boosting.png" referrerpolicy="no-referrer" alt="Boosting"></p><h3 id='ml-알고리즘-소개--5-gradient-boosted-tree'><span>ML 알고리즘 소개 : 5) Gradient Boosted Tree</span></h3><p><span>Boosting Algorithm의 가중치 변경(</span><font color='red'><span>오류 보정</span></font><span>)에 머신 러닝에서 많이 사용되는 </span><font color='red'><span>경사 하강법(Gradient Descent)</span></font><span>을 사용한다. 분류와 회귀에 모두 사용된다. GBT의 </span><font color='red'><span>느린 수행 시간과 과적합 문제를 해결</span></font><span>한 </span><font color='red'><span>XGBoost, LightBoost</span></font><span>등으로로 발전되어 분류 분야에서 많이 사용되고 있습니다.</span></p><p><img src="http://velucid.github.io/oci/oke/images/ai-ml/oci-oke-gradient-descent.png" referrerpolicy="no-referrer" alt="Boosting"></p><h4 id='4-5-gbt-classifier-분석-결과-94'><span>4-5) GBT Classifier 분석 결과 (94%)</span></h4><ul><li><span>수행 코드</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">pyspark</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span>.<span class="cm-property">classification</span> <span class="cm-keyword">import</span> <span class="cm-variable">GBTClassifier</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span>.<span class="cm-property">evaluation</span> <span class="cm-keyword">import</span> <span class="cm-variable">BinaryClassificationEvaluator</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">gbt</span> = <span class="cm-variable">GBTClassifier</span>(<span class="cm-variable">maxIter</span>=<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">gbtModel</span> = <span class="cm-variable">gbt</span>.<span class="cm-property">fit</span>(<span class="cm-variable">train</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">predictions</span> = <span class="cm-variable">gbtModel</span>.<span class="cm-property">transform</span>(<span class="cm-variable">test</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">predictions</span>.<span class="cm-property">select</span>(<span class="cm-string">'label'</span>, <span class="cm-string">'prediction'</span>, <span class="cm-string">'probability'</span>, <span class="cm-string">'HOUSEHOLD_SIZE'</span>, <span class="cm-string">'YRS_RESIDENCE'</span>, <span class="cm-string">'CUST_MARITAL_STATUS'</span>).<span class="cm-property">show</span>(<span class="cm-number">5</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">evaluator</span> = <span class="cm-variable">BinaryClassificationEvaluator</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"Test Area Under ROC: "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">evaluator</span>.<span class="cm-property">evaluate</span>(<span class="cm-variable">predictions</span>, {<span class="cm-variable">evaluator</span>.<span class="cm-property">metricName</span>: <span class="cm-string">"areaUnderROC"</span>})))</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 322px;"></div><div class="CodeMirror-gutters" style="display: none; height: 322px;"></div></div></div></pre><ul><li><span>수행 결과</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.25px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+-----+----------+--------------------+--------------+-------------+-------------------+</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|label|prediction| &nbsp; &nbsp; &nbsp; &nbsp; probability|HOUSEHOLD_SIZE|YRS_RESIDENCE|CUST_MARITAL_STATUS|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+-----+----------+--------------------+--------------+-------------+-------------------+</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0| &nbsp; &nbsp; &nbsp; 0.0|[0.90477470826839...| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0| &nbsp; &nbsp; &nbsp; 0.0|[0.90477470826839...| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0| &nbsp; &nbsp; &nbsp; 0.0|[0.90477470826839...| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  1| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0| &nbsp; &nbsp; &nbsp; 1.0|[0.37712590300593...| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|  0.0| &nbsp; &nbsp; &nbsp; 1.0|[0.22325900010031...| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  5| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Married|</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+-----+----------+--------------------+--------------+-------------+-------------------+</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">only showing top 5 rows</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Test Area Under ROC: 0.9478295989323592</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 483px;"></div><div class="CodeMirror-gutters" style="display: none; height: 483px;"></div></div></div></pre><hr /></div></div>
</body>
</html>
